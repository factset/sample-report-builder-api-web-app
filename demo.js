/**
  Vue application that transforms a FactSet Report Builder API response into a simple table.

  This application is tailored to the displaying of data that represents its parent-child relationships using STACH group level cell metadata.
*/

// Controls the amount of indentation for a table's group level
const INDENTATION = 50;

// https://vuejs.org/v2/guide/
const app = new Vue({
  el: "#app",
  data: {
    table: {},
  },
  // Called on app load
  async created() {
    try {
      const response = await fetchData();
      const stachPackage = new StachExtension(response);
      this.table = stachPackage.tables[0];
    } catch (e) {
      console.error(e);
    }
  },
  methods: {
    getIndentation: function(groupLevel, index) {
      const base = 8;
      // Only indent dimension cell
      if (index !== 0) {
        return `${base}px`;
      }
      return `${INDENTATION * groupLevel + base}px`;
    }
  },
});

class StachExtension {
  tables = [];

  constructor(stachData) {
    const tableEntries = stachData?.data?.tables ?? {};
    const tableKeys = Object.keys(tableEntries);
    tableKeys.forEach(key => {
      this.tables.push(this.generateTable(tableEntries[key]));
    });
  }

  generateTable(tableEntry) {
    const headerRows = [];
    const dataRows = [];

    const rows = tableEntry.data.rows;
    const columnDefinitions = tableEntry.definition.columns;
    const headersDefinitions = tableEntry.headersDefinition.columns;

    for (let rowIndex = 0; rowIndex < rows.length; rowIndex++) {
      const filteredCells = [];
      const cells = rows[rowIndex].cells;

      if (this.isHeaderRow(rows[rowIndex])) {
        // Skip hidden header rows
        if (this.isHidden(headersDefinitions[rowIndex])) {
          continue;
        }

        headerRows.push(rows[rowIndex].cells);
        continue;
      }

      for (let colIndex = 0; colIndex < cells.length; colIndex++) {
        // Only push non-hidden column cells
        if (!this.isHidden(columnDefinitions[colIndex])) {
          filteredCells.push(cells[colIndex]);
        }
      }

      dataRows.push({
        cells: filteredCells,
        groupLevel: rows[rowIndex].cellDetails?.[0]?.groupLevel,
        category: rows[rowIndex].rowMetadata?.category?.value,
      });
    }

    return {
      headerRows,
      dataRows,
    };
  }

  isHeaderRow(row) {
    return row.rowType === 'Header';
  }

  isHidden(columnDefinition) {
    return columnDefinition.isHidden;
  }
}

async function fetchData() {
  // API fetch logic goes here
  return Promise.resolve(getDummyData());
}

function getDummyData() {
  // One may replace the object returned here with any FactSet Report Builder API response
  return {"data":{"version":"2.0","tables":{"main":{"definition":{"columns":[{"id":"lineItem","isDimension":true,"type":"string"},{"id":"period1","type":"real"},{"id":"period2","type":"real"},{"id":"period3","type":"real"},{"id":"period4","type":"real"},{"id":"period5","type":"real"},{"id":"period6","type":"real"},{"id":"period7","type":"real"},{"id":"period8","type":"real"},{"id":"period9","type":"real"},{"id":"period10","type":"real"},{"id":"period11","type":"real"}]},"data":{"rows":[{"rowType":"Header","cells":[null,"Aug' 20","May' 20","Feb' 20","Nov' 19","Aug' 19","May' 19","Feb' 19","Nov' 18","Aug' 18","May' 18","Feb' 18"],"headerCellDetails":{"0":{"source":"PRIMARY","columnIndex":0},"1":{"source":"HEADERS","columnIndex":0},"2":{"source":"HEADERS","columnIndex":0},"3":{"source":"HEADERS","columnIndex":0},"4":{"source":"HEADERS","columnIndex":0},"5":{"source":"HEADERS","columnIndex":0},"6":{"source":"HEADERS","columnIndex":0},"7":{"source":"HEADERS","columnIndex":0},"8":{"source":"HEADERS","columnIndex":0},"9":{"source":"HEADERS","columnIndex":0},"10":{"source":"HEADERS","columnIndex":0},"11":{"source":"HEADERS","columnIndex":0}}},{"rowType":"Header","cells":[null,"20200831","20200529","20200228","20191129","20190830","20190531","20190228","20181130","20180831","20180531","20180228"],"headerCellDetails":{"0":{"source":"PRIMARY","columnIndex":0},"1":{"source":"HEADERS","columnIndex":1},"2":{"source":"HEADERS","columnIndex":1},"3":{"source":"HEADERS","columnIndex":1},"4":{"source":"HEADERS","columnIndex":1},"5":{"source":"HEADERS","columnIndex":1},"6":{"source":"HEADERS","columnIndex":1},"7":{"source":"HEADERS","columnIndex":1},"8":{"source":"HEADERS","columnIndex":1},"9":{"source":"HEADERS","columnIndex":1},"10":{"source":"HEADERS","columnIndex":1},"11":{"source":"HEADERS","columnIndex":1}}},{"cells":["Sales",383.59,374.083,369.78,366.658,364.283,364.533,354.895,351.64,345.861,339.911,335.231],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_SALES"}}},{"cells":["Cost of Goods Sold (COGS) incl. D&A",183.568,170.703,176.218,164.957,167.73,163.832,165.108,166.776,169.467,165.073,163.232],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"DETAIL"},"scale":{"value":6},"metricFundamentals":{"value":"FF_COGS"}}},{"cells":["COGS excluding D&A",167.287,157.666,162.312,150.567,151.21,148.941,150.297,152.535,155.03,150.597,149.146],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_COGS_XDEP"}}},{"cells":["Depreciation & Amortization Expense",16.281,13.037,13.906,14.39,16.52,14.891,14.811,14.241,14.437,14.476,14.086],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_DEP_AMORT_EXP"}}},{"cells":["Depreciation",9.414,7.93,8.763,9.238,9.12,8.891,9.011,8.341,8.337,8.276,7.886],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_DEP_EXP"}}},{"cells":["Amortization of Intangibles",6.867,5.107,5.143,5.152,7.4,6,5.8,5.9,6.1,6.2,6.2],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_AMORT_INTANG"}}},{"cells":["Amortization of Deferred Charges",0,0,0,0,null,null,null,0,null,null,null],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_AMORT_DFD_CHRG"}}},{"cells":["Gross Income",200.022,203.38,193.562,201.701,196.553,200.701,189.787,184.864,176.394,174.838,171.999],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_GROSS_INC"}}},{"cells":["SG&A Expense",85.49,80.721,86.956,87.781,84.572,82.864,80.714,83.926,88.513,82.614,77.338],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"DETAIL"},"scale":{"value":6},"metricFundamentals":{"value":"FF_SGA"}}},{"cells":["Research & Development",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6}}},{"cells":["Other SG&A",85.49,80.721,86.956,87.781,84.572,82.864,80.714,83.926,88.513,82.614,77.338],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_SGA_OTH"}}},{"cells":["Other Operating Expense",0,0,0,0,0,0,0,0,0,0,null],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"DETAIL"},"scale":{"value":6},"metricFundamentals":{"value":"FF_OPER_EXP_OTH"}}},{"cells":["EBIT (Operating Income)",114.532,122.659,106.606,113.92,111.981,117.837,109.073,100.938,87.881,92.224,94.661],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_EBIT_OPER"}}},{"cells":["Nonoperating Income - Net",-0.346,-0.619,0.303,-0.979,1.008,0.747,0.376,-0.295,0.654,1.587,1.152],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"DETAIL"},"scale":{"value":6},"metricFundamentals":{"value":"FF_NON_OPER_INC"}}},{"cells":["Nonoperating Interest Income",0.174,0.689,1.139,1.069,1.421,1.344,0.761,0.104,0.179,0.546,0.328],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_INT_INC_NON_OPER"}}},{"cells":["Equity in Earnings of Affiliates",0,0,0,0,0,0,0,0,0,0,0],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_EQ_AFF_INC_PTX"}}},{"cells":["Reserves Increase (Decrease)",0,0,0,0,0,0,0,0,0,0,0],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_RSRV_CHG"}}},{"cells":["Other Income (Expense)",-0.52,-1.308,-0.836,-2.048,-0.413,-0.597,-0.385,-0.399,0.475,1.041,0.824],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_MISC_EXP_NON_OPER"}}},{"cells":["Interest Expense",1.542,2.9,3.8,4.2,4.7,5.2,5.1,4.7,4.6,4.3,3.6],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"DETAIL"},"scale":{"value":6},"metricFundamentals":{"value":"FF_INT_EXP_NET"}}},{"cells":["Gross Interest Expense",1.542,2.9,3.8,4.2,4.7,5.2,5.1,4.7,4.6,4.3,3.6],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_INT_EXP_DEBT"}}},{"cells":["Interest Capitalized",0,0,0,0,0,0,0,0,0,0,0],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_INT_CAP"}}},{"cells":["Unusual Expense - Net",16.5,0,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"DETAIL"},"scale":{"value":6},"metricFundamentals":{"value":"FF_UNUSUAL_EXP"}}},{"cells":["Impairments",16.5,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_IMPAIR"}}},{"cells":["Goodwill",0,0,0,0,0,0,0,0,0,0,0],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_GW_IMPAIR"}}},{"cells":["Other Intangibles",0,0,0,0,0,0,0,0,0,0,0],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_INTANG_OTH_IMPAIR"}}},{"cells":["Property, Plant & Equipment",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_PPE_IMPAIR"}}},{"cells":["Financial Fixed Assets",16.5,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_FIX_ASSETS_IMPAIR"}}},{"cells":["Exceptional Provisions",0,0,0,0,0,0,0,0,0,0,0],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_XCEPT_PROV"}}},{"cells":["Restructuring Expense",0,0,0,0,0,0,0,0,0,0,0],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_RESTRUCT_EXP"}}},{"cells":["Legal Claim Expense",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_LEGAL_CLAIM_EXP"}}},{"cells":["Unrealized Valuation Gain/Loss",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_UNREAL_GL_TOT"}}},{"cells":["Investments",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_UNREAL_GL_INVEST"}}},{"cells":["Investment Property",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_UNREAL_GL_PROP"}}},{"cells":["Biological Assets",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_UNREAL_GL_BIO_ASSETS"}}},{"cells":["Hedges/Derivatives",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_UNREAL_GL_DERIV"}}},{"cells":["Other",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_UNREAL_GL_OTH"}}},{"cells":["Excpl Chrgs- Other",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_OTH_XCEPT_CHRG"}}},{"cells":["Restructuring Of Debt",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_RESTRUCT_DEBT"}}},{"cells":["Early Termination Of Contracts Costs (Income)",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_EARLY_TERM_CONTRACT"}}},{"cells":["Acquired In-Process R&D",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_ACQ_PROCESS_RD"}}},{"cells":["Calamitous Events",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_CALAMITOUS_EVENT"}}},{"cells":["Accelerated Depreciation",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_ACCEL_DEP"}}},{"cells":["Unusual Expense- Other- Misc",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_OTH_UNUSUAL_EXP"}}},{"cells":["Pretax Income",96.144,119.14,103.109,108.741,108.289,113.384,104.349,95.943,83.935,89.511,92.213],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_PTX_INC"}}},{"cells":["Income Taxes",7.065,17.924,14.423,14.784,16.762,21.119,19.647,11.647,15.112,14.765,39.076],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"DETAIL"},"scale":{"value":6},"metricFundamentals":{"value":"FF_INC_TAX"}}},{"cells":["Income Taxes - Current Domestic",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_INC_TAX_CURR_DOM"}}},{"cells":["Income Taxes - Current Foreign",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_INC_TAX_CURR_FOR"}}},{"cells":["Income Taxes - Deferred Domestic",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_INC_TAX_DFD_DOM"}}},{"cells":["Income Taxes - Deferred Foreign",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_INC_TAX_DFD_FOR"}}},{"cells":["Income Tax Credits",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_ITC"}}},{"cells":["Equity in Earnings of Affiliates",0,0,0,0,0,0,0,0,0,0,0],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"DETAIL"},"scale":{"value":6},"metricFundamentals":{"value":"FF_EQ_AFF_INC"}}},{"cells":["Other After Tax Adjustments",0,0,0,0,0,0,0,0,0,0,0],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"DETAIL"},"scale":{"value":6},"metricFundamentals":{"value":"FF_ADJ_NET_OTH"}}},{"cells":["Consolidated Net Income",89.079,101.216,88.686,93.957,91.527,92.265,84.702,84.296,68.823,74.746,53.137],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_CONSOL_NET_INC"}}},{"cells":["Minority Interest",0,0,0,0,0,0,0,0,0,0,0],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"DETAIL"},"scale":{"value":6},"metricFundamentals":{"value":"FF_MIN_INT_EXP"}}},{"cells":["Net Income",89.079,101.216,88.686,93.957,91.527,92.265,84.702,84.296,68.823,74.746,53.137],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_NET_INC"}}},{"cells":["Discontinued Operations",0,0,0,0,0,0,0,0,0,0,0],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"DETAIL"},"scale":{"value":6},"metricFundamentals":{"value":"FF_DISC_OPER"}}},{"cells":["Preferred Dividends",0,0,0,0,0,0,0,0,0,0,0],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"DETAIL"},"scale":{"value":6},"metricFundamentals":{"value":"FF_DIV_PFD"}}},{"cells":["Net Income available to Common",89.079,101.216,88.686,93.957,91.527,92.265,84.702,84.296,68.823,74.746,53.137],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"DETAIL"},"scale":{"value":6},"metricFundamentals":{"value":"FF_NET_INC_BASIC"}}},{"cells":["Per Share",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"SECTION"},"scale":{"value":6}}},{"cells":["EPS (recurring)",2.584206,2.630285,2.298994,2.434939,2.343481,2.366194,2.193273,2.172073,1.770184,1.911467,1.333559],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"DETAIL"},"scale":{"value":0},"metricFundamentals":{"value":"FF_EPS_DIL_BEF_UNUSUAL"}}},{"cells":["EPS (basic)",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"DETAIL"},"scale":{"value":0},"metricFundamentals":{"value":"FF_EPS_BASIC"}}},{"cells":["Basic Shares Outstanding",38.012681,37.885,37.875,37.978,38.189746,38.223,38.055,38.106,38.235,38.594,38.991],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_COM_SHS_OUT_EPS_BASIC"}}},{"cells":["Total Shares Outstanding",38.030252,37.907127,37.849247,37.904178,38.11784,38.217763,38.100165,38.080878,38.192586,38.384581,38.927153],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_COM_SHS_OUT"}}},{"cells":["EPS (diluted)",2.2876,2.6303,2.299,2.4349,2.3435,2.37,2.19,2.17,1.77,1.91,1.33],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"DETAIL"},"scale":{"value":0},"metricFundamentals":{"value":"FF_EPS_DIL"}}},{"cells":["Diluted Shares Outstanding",38.94,38.481,38.576,38.587,39.056,38.993,38.619,38.809,38.879,39.104,39.846],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_COM_SHS_OUT_EPS_DIL"}}},{"cells":["Total Shares Outstanding",38.030252,37.907127,37.849247,37.904178,38.11784,38.217763,38.100165,38.080878,38.192586,38.384581,38.927153],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_COM_SHS_OUT"}}},{"cells":["Earnings Persistence",77.865,80.409,81.181,81.384,94.585,93.095,95.29,90.978,87.282,86.326,74.537],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"DETAIL"},"scale":{"value":6},"metricFundamentals":{"value":"FF_EARN_PERST"}}},{"cells":["Dividends per Share",0.77,0.77,0.72,0.72,0.72,0.72,0.64,0.64,0.64,0.64,0.56],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"DETAIL"},"scale":{"value":0},"metricFundamentals":{"value":"FF_DPS"}}},{"cells":["Payout Ratio",33.659731,29.274227,31.317964,29.570003,30.723277,30.379747,29.223744,29.493088,36.158192,33.507853,42.105263],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"valueType":{"value":"PERCENTAGE"},"metricFundamentals":{"value":"FF_PAY_OUT_RATIO"}}},{"cells":["EBITDA",null,null,null,null,null,null,null,null,null,null,null],"cellDetails":{"0":{"groupLevel":0}},"rowMetadata":{"category":{"value":"SECTION"},"scale":{"value":6}}},{"cells":["EBITDA",130.813,135.696,120.512,128.31,128.501,132.728,123.884,115.179,102.318,106.7,108.747],"cellDetails":{"0":{"groupLevel":1}},"rowMetadata":{"category":{"value":"DETAIL"},"scale":{"value":6},"metricFundamentals":{"value":"FF_EBITDA_OPER"}}},{"cells":["EBIT",114.532,122.659,106.606,113.92,111.981,117.837,109.073,100.938,87.881,92.224,94.661],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6},"metricFundamentals":{"value":"FF_EBIT_OPER"}}},{"cells":["Depreciation & Amortization Expense",16.281,13.037,13.906,14.39,16.52,14.891,14.811,14.241,14.437,14.476,14.086],"cellDetails":{"0":{"groupLevel":2}},"rowMetadata":{"category":{"value":"MAIN"},"scale":{"value":6}}}]},"headersDefinition":{"columns":[{"id":"dates_display","type":"string","isDimension":true},{"id":"dates_value","type":"string","isDimension":true,"isHidden":true}]}}}},"meta":{"requestId":"FDS","fsymId":"0016YD-E"}};
}
